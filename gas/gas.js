(function($){if(window.SIM===undefined){SIM={};SIM.init=function(){$(".sim-gas-widget").each(function(){var formInputHtml='<span class="sim-gas-city"></span><span class="sim-gas-price1"></span><span class="sim-gas-price2"></span><span class="sim-gas-price3"></span><input type="text" class="sim-gas-zip" maxlength="5" value="Zip"/><input type="button" class="sim-gas-button"/>';$(this).find(".sim-gas-price").html(formInputHtml);SIM.getGas($(this))});$(".sim-gas-button").click($.proxy(SIM.submitWidget,$(this)));$(".sim-gas-zip").focus(function(){$(this).val(($(this).val()==="Zip")?"":$(this).val())}).blur(function(){$(this).val(($(this).val()==="")?"Zip":$(this).val())})};SIM.isNumeric=function(s){var isWhole_re=/^\s*\d+\s*$/;return String(s).search(isWhole_re)!=-1};SIM.defaultSubmit=function(myEvent,submitButtonID){if(myEvent.keyCode==13){myEvent.keyCode=null;window.document.getElementById(submitButtonID).click()}return true};SIM.getGas=function(widgetWrapper){var zipCode=jQuery.trim(widgetWrapper.data("datasetid")),callbackFunc=((arguments[1]!==undefined)?arguments[1]:null);jQuery.ajax({url:"http://affddl.automotive.com/widgets/gas/2/API_gas.php"+(zipCode!==""?"?zip="+zipCode:""),dataType:"jsonp",success:function(data){if(data.meta.count>0){var region=data.content.City,gasPrice=parseFloat(data.content.AvgPrice).toFixed(2),priceText=" Average Price";if(region!="National"){priceText=" Cheapest Price";if(widgetWrapper.hasClass("sim-gaswidget-160")){priceText=""}region=region+", "+data.content.RegionShort+priceText;gasPrice=parseFloat(data.content.MinPrice).toFixed(2)}else{region+=priceText}widgetWrapper.find(".sim-gas-price1").html(gasPrice.substr(0,1));widgetWrapper.find(".sim-gas-price2").html(gasPrice.substr(2,1));widgetWrapper.find(".sim-gas-price3").html(gasPrice.substr(3,1));widgetWrapper.find(".sim-gas-city").html(region);if(callbackFunc!==null){if(typeof callbackFunc==="function"){callbackFunc.apply()}}}}})};SIM.submitWidget=function(widgetWrapper){widgetWrapper=$(widgetWrapper.target);var myTextBoxValue=widgetWrapper.siblings(".sim-gas-zip").val();if(!SIM.isNumeric(myTextBoxValue)||myTextBoxValue.length!=5){window.open("http://www.automotive.com/gas-prices/index.html")}else{window.open("http://www.automotive.com/gas-prices/results.html?zip="+myTextBoxValue)}};$(function(){SIM.init()})}})(jQuery);